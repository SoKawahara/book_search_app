<% provide(:title, "おすすめの本を選ぶ") %>
<h1 class="new-title">おすすめの本を選ぶ</h1>
<!-- 配列に対してempty?メソッドを適用すると対象となる配列が空であるのかを確認する -->
<section class="parent">
  <% if !@posts.empty? %>
    <h3 class="caution">(*選択するには投稿右上のチェックボタンを押してください)</h3>
    <section class = "posts-container">
      <% @posts.each do |item| %>
          <section class="post-container">
            <%= image_tag(eval(item.book_data)["imageLink"]) %>
            <div class="content">
              <!-- 感想をdata属性としてタグの中に含ませておく -->
              <p class = "post-name" data-post-content = <%= item.content %> data-post-id = <%= item.id %> data-user-id = <%= item.user_id %>><%= item.post_name %></p>
              <!-- gsubメソッドを用いることで第１引数の値を第２引数の値で置き換えることができる -->
              <p>作成日時:<%= (item.created_at.getlocal("+09:00")).to_s.gsub("+0900" , "") %></p>
            </div>
            <p class = "good-content"><%= image_tag("good.png" , class: "good-img") %><%= item.who_goods.count %></p>
            <%= link_to image_tag("check.svg") , "/users/profile/view_top/#{item.id}/#{@id}" , class: "edit-btn" %>
            <%= link_to "詳細を見る" , "/posts/#{item.user_id}/#{item.id}" , class: "view-post-btn"%>
          </section>
      <% end %>
    </section>
    <%= paginate @posts, theme: "bootstrap-5" %>
  <% else %>
    <p class = "caution" style = "margin-top: 15rem">選択できる投稿がありません。下記のリンクから投稿を作成してください</p>
    <%= link_to "投稿を作成する" , "/searches" , class: "create-post-btn" %>
  <% end %>
</section>

